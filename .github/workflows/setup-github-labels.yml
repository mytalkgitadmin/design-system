name: Setup GitHub Labels

on:
  workflow_dispatch:

jobs:
  setup-labels:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Create work management labels
        run: |
          echo "ðŸ·ï¸  GitHub ë¼ë²¨ ì„¤ì • ì¤‘..."
          echo ""
          echo "ðŸ“ ìž‘ì—… ê´€ë¦¬ ë¼ë²¨ ìƒì„± ì¤‘..."

          # work:start ë¼ë²¨
          gh label create "work:start" \
            --color "10B981" \
            --description "ðŸš€ ìž‘ì—… ì‹œìž‘ - Jira Work Log ì‹œìž‘" \
            --force || echo "âœ… 'work:start' ë¼ë²¨ ì—…ë°ì´íŠ¸ ì™„ë£Œ"

          # work:end ë¼ë²¨
          gh label create "work:end" \
            --color "EF4444" \
            --description "âœ… ìž‘ì—… ì¢…ë£Œ - Jira Work Log ì¢…ë£Œ" \
            --force || echo "âœ… 'work:end' ë¼ë²¨ ì—…ë°ì´íŠ¸ ì™„ë£Œ"
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Create status management labels
        run: |
          echo ""
          echo "ðŸ“Š ìƒíƒœ ê´€ë¦¬ ë¼ë²¨ ìƒì„± ì¤‘..."

          # in progress ë¼ë²¨
          gh label create "in progress" \
            --color "F59E0B" \
            --description "ðŸŸ¡ ì§„í–‰ ì¤‘ - Jira: In Progress" \
            --force || echo "âœ… 'in progress' ë¼ë²¨ ì—…ë°ì´íŠ¸ ì™„ë£Œ"

          # review ë¼ë²¨
          gh label create "review" \
            --color "3B82F6" \
            --description "ðŸ”µ ë¦¬ë·° ì¤‘ - Jira: In Review" \
            --force || echo "âœ… 'review' ë¼ë²¨ ì—…ë°ì´íŠ¸ ì™„ë£Œ"

          # blocked ë¼ë²¨
          gh label create "blocked" \
            --color "6B7280" \
            --description "ðŸš« ë¸”ë¡œí‚¹ë¨ - Jira: Blocked" \
            --force || echo "âœ… 'blocked' ë¼ë²¨ ì—…ë°ì´íŠ¸ ì™„ë£Œ"
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Create Summary
        run: |
          echo ""
          echo "ðŸŽ‰ ë¼ë²¨ ì„¤ì • ì™„ë£Œ!"
          echo ""
          echo "âœ… ìƒì„±ëœ ë¼ë²¨:"
          gh label list --json name,description,color | jq -r '.[] | select(.name | test("work:|in progress|review|blocked")) | "  - \(.name) (\(.color)): \(.description)"'
          echo ""
          echo "ðŸ“Œ ë‹¤ìŒ ë‹¨ê³„:"
          echo "  1. GitHub Issue ìƒì„±"
          echo "  2. 'work:start' ë¼ë²¨ ì¶”ê°€ë¡œ ìž‘ì—… ì‹œìž‘"
          echo "  3. 'review' ë¼ë²¨ ì¶”ê°€ë¡œ ë¦¬ë·° ìš”ì²­"
          echo "  4. 'work:end' ë¼ë²¨ ì¶”ê°€ë¡œ ìž‘ì—… ì™„ë£Œ"

          # GitHub Actions Summary ìƒì„±
          echo "## ðŸŽ‰ GitHub ë¼ë²¨ ì„¤ì • ì™„ë£Œ!" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### ðŸ·ï¸ ìƒì„±ëœ ë¼ë²¨" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "#### ìž‘ì—… ê´€ë¦¬" >> $GITHUB_STEP_SUMMARY
          echo "- ðŸš€ \`work:start\` - ìž‘ì—… ì‹œìž‘ (Jira Work Log ì‹œìž‘)" >> $GITHUB_STEP_SUMMARY
          echo "- âœ… \`work:end\` - ìž‘ì—… ì¢…ë£Œ (Jira Work Log ì¢…ë£Œ)" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "#### ìƒíƒœ ê´€ë¦¬" >> $GITHUB_STEP_SUMMARY
          echo "- ðŸŸ¡ \`in progress\` - ì§„í–‰ ì¤‘ (Jira: In Progress)" >> $GITHUB_STEP_SUMMARY
          echo "- ðŸ”µ \`review\` - ë¦¬ë·° ì¤‘ (Jira: In Review)" >> $GITHUB_STEP_SUMMARY
          echo "- ðŸš« \`blocked\` - ë¸”ë¡œí‚¹ë¨ (Jira: Blocked)" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### ðŸ’¡ ì‚¬ìš© ë°©ë²•" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "1. **ìž‘ì—… ì‹œìž‘**: Issueì— \`work:start\` ë¼ë²¨ ì¶”ê°€" >> $GITHUB_STEP_SUMMARY
          echo "2. **ìƒíƒœ ë³€ê²½**: \`in progress\`, \`review\`, \`blocked\` ë¼ë²¨ ì¶”ê°€" >> $GITHUB_STEP_SUMMARY
          echo "3. **ìž‘ì—… ì¢…ë£Œ**: Issueì— \`work:end\` ë¼ë²¨ ì¶”ê°€" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "ëª¨ë“  ë¼ë²¨ ë³€ê²½ì€ ìžë™ìœ¼ë¡œ Jiraì™€ ë™ê¸°í™”ë©ë‹ˆë‹¤!" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "---" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "**ë‹¤ìŒ ë‹¨ê³„**: Actions íƒ­ì—ì„œ **Get Jira Transitions** ì›Œí¬í”Œë¡œìš°ë¥¼ ì‹¤í–‰í•˜ì—¬ Transition IDë¥¼ í™•ì¸í•˜ì„¸ìš”." >> $GITHUB_STEP_SUMMARY
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
